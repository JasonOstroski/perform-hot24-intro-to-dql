{"version":"5","defaultTimeframe":{"from":"now-2h","to":"now"},"sections":[{"id":"adbee822-325b-4549-b3d2-b6d6e895d873","type":"markdown","markdown":"# Davis Copilot\n## DQL is super powerful, but what if we could use generative AI to do some of the hard work for us?\n![](https://mkt-cdn.dynatrace.com/assets/Marketing/content-images/_1920x921_crop_center-center_100_line/davis-chart.png.webp)\n\n## Exercise 1: Let's use Davis CoPilot to build the DQL for some of the previous exercises\n1. Give me the count of all SEVERE and ERROR logs grouped by log level with a 5-minute interval\n2. Count the current number of active problems \n3. Identify the top 10 most problem affected entities within your environment\n4.  Count the \"com.easytrade.buy.start\" biz events summarized by \"accountId\" and summarized by timestamp\n\n## Experiment with Davis CoPilot and see what's possible!"},{"id":"963dc1c0-df22-46b9-a2ad-29b6b0d3a096","type":"dql","showTitle":false,"state":{"input":{"value":"fetch logs\n| filter loglevel == \"SEVERE\" OR loglevel == \"ERROR\"\n| makeTimeseries by:{loglevel}, interval:5m, count = count()","timeframe":{"from":"now-2h","to":"now"}},"visualization":"barChart","state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","isBackgroundThresholdActive":false},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[["content"]],"firstVisibleRowIndex":0,"columnWidths":{}}},"result":{"code":200,"value":{"records":[{"timeframe":{"start":"2023-12-19T18:35:00.000Z","end":"2023-12-19T20:40:00.000Z"},"interval":"300000000000","loglevel":"ERROR","count":[345,931,931,919,916,959,938,921,918,904,908,931,965,913,923,915,927,908,935,934,951,936,946,903,235]}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| filter loglevel == \"SEVERE\" OR loglevel == \"ERROR\"\n| makeTimeseries by:{loglevel}, interval:5m, count(), alias:count","timezone":"America/New_York","query":"fetch logs\n| filter loglevel == \"SEVERE\" OR loglevel == \"ERROR\"\n| makeTimeseries by:{loglevel}, interval:5m, count = count()","scannedRecords":2193919,"dqlVersion":"V1_0","scannedBytes":247968884,"analysisTimeframe":{"start":"2023-12-19T18:38:08.852Z","end":"2023-12-19T20:38:08.852Z"},"locale":"","executionTimeMilliseconds":40,"notifications":[],"queryId":"b729531b-24fa-4deb-866f-4e2d6da33cf3","sampled":false}},"types":[{"mappings":{"timeframe":{"type":"timeframe"},"interval":{"type":"duration"},"loglevel":{"type":"string"},"count":{"type":"array","types":[{"mappings":{"element":{"type":"double"}},"indexRange":[0,24]}]}},"indexRange":[0,0]}]},"notifications":[],"dateTime":"2023-12-19T20:38:08.835Z","input":{"value":"fetch logs\n| filter loglevel == \"SEVERE\" OR loglevel == \"ERROR\"\n| makeTimeseries by:{loglevel}, interval:5m, count = count()","timeframe":{"from":"now-2h","to":"now"}}}},"subType":"davis-copilot","davisCopilot":{"prompt":"Give me the count of all SEVERE and ERROR logs grouped by log level with a 5-minute interval","response":{"status":"success","data":{"dql":"fetch logs\n| filter loglevel == \"SEVERE\" OR loglevel == \"ERROR\"\n| makeTimeseries by:{loglevel}, interval:5m, count = count()","status":"SUCCESSFUL","metadata":{"notifications":[]},"prompt":"Give me the count of all SEVERE and ERROR logs grouped by log level with a 5-minute interval"}},"showDqlSnippet":false},"height":216},{"id":"1dc1e123-3df4-4669-ac9c-07bf6f120dc8","type":"dql","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.kind == \"DAVIS_PROBLEM\"\n| sort timestamp asc\n| summarize by:{event.id}, event.status = takeLast(event.status)\n| filter event.status == \"ACTIVE\"\n| summarize activeEvents = countDistinct(event.id)","timeframe":{"from":"now-2h","to":"now"}},"visualization":"recordView","state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","isBackgroundThresholdActive":false},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}},"result":{"code":200,"value":{"records":[{"activeEvents":"2"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.kind == \"DAVIS_PROBLEM\"\n| sort timestamp, direction:\"ascending\"\n| summarize by:{event.id}, takeLast(event.status), alias:event.status\n| filter event.status == \"ACTIVE\"\n| summarize countDistinct(event.id), alias:activeEvents","timezone":"America/New_York","query":"fetch events\n| filter event.kind == \"DAVIS_PROBLEM\"\n| sort timestamp asc\n| summarize by:{event.id}, event.status = takeLast(event.status)\n| filter event.status == \"ACTIVE\"\n| summarize activeEvents = countDistinct(event.id)","scannedRecords":4992,"dqlVersion":"V1_0","scannedBytes":1121877,"analysisTimeframe":{"start":"2023-12-19T18:10:10.003Z","end":"2023-12-19T20:10:10.003Z"},"locale":"","executionTimeMilliseconds":34,"notifications":[],"queryId":"e4ea4f0d-8daf-4530-a989-894d490d02bd","sampled":false}},"types":[{"mappings":{"activeEvents":{"type":"long"}},"indexRange":[0,0]}]},"notifications":[],"dateTime":"2023-12-19T20:10:09.987Z","input":{"value":"fetch events\n| filter event.kind == \"DAVIS_PROBLEM\"\n| sort timestamp asc\n| summarize by:{event.id}, event.status = takeLast(event.status)\n| filter event.status == \"ACTIVE\"\n| summarize activeEvents = countDistinct(event.id)","timeframe":{"from":"now-2h","to":"now"}}}},"subType":"davis-copilot","davisCopilot":{"prompt":"Count the current number of active problems","response":{"status":"success","data":{"dql":"fetch events\n| filter event.kind == \"DAVIS_PROBLEM\"\n| sort timestamp asc\n| summarize by:{event.id}, event.status = takeLast(event.status)\n| filter event.status == \"ACTIVE\"\n| summarize activeEvents = countDistinct(event.id)","status":"SUCCESSFUL","metadata":{"notifications":[]},"prompt":"Count the current number of active problems"}},"showDqlSnippet":true},"height":134},{"id":"5121856e-a925-4a06-8a21-f713a751bb4b","type":"dql","showTitle":false,"state":{"input":{"value":"fetch events\n| filter event.kind == \"DAVIS_PROBLEM\"\n| expand affected_entity_ids\n| summarize by:{affected_entity_ids}, count = countDistinct(display_id)\n| sort count desc\n| limit 10","timeframe":{"from":"now-2h","to":"now"}},"visualization":"recordView","state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"affected_entity_ids","categoryAxisLabel":"affected_entity_ids","valueAxis":"count","valueAxisLabel":"count"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","isBackgroundThresholdActive":false},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}},"result":{"code":200,"value":{"records":[{"affected_entity_ids":"CLOUD_APPLICATION-0EC8F8343DDF56E5","count":"3"},{"affected_entity_ids":"CLOUD_APPLICATION-228CCEE0EAA2804F","count":"1"}],"metadata":{"grail":{"canonicalQuery":"fetch events\n| filter event.kind == \"DAVIS_PROBLEM\"\n| expand affected_entity_ids\n| summarize by:{affected_entity_ids}, countDistinct(display_id), alias:count\n| sort count, direction:\"descending\"\n| limit 10","timezone":"America/New_York","query":"fetch events\n| filter event.kind == \"DAVIS_PROBLEM\"\n| expand affected_entity_ids\n| summarize by:{affected_entity_ids}, count = countDistinct(display_id)\n| sort count desc\n| limit 10","scannedRecords":4993,"dqlVersion":"V1_0","scannedBytes":1122524,"analysisTimeframe":{"start":"2023-12-19T18:10:51.690Z","end":"2023-12-19T20:10:51.690Z"},"locale":"","executionTimeMilliseconds":24,"notifications":[],"queryId":"e3072b1e-76d1-407e-ba1a-0b76522bd7e6","sampled":false}},"types":[{"mappings":{"affected_entity_ids":{"type":"string"},"count":{"type":"long"}},"indexRange":[0,1]}]},"notifications":[],"dateTime":"2023-12-19T20:10:51.672Z","input":{"value":"fetch events\n| filter event.kind == \"DAVIS_PROBLEM\"\n| expand affected_entity_ids\n| summarize by:{affected_entity_ids}, count = countDistinct(display_id)\n| sort count desc\n| limit 10","timeframe":{"from":"now-2h","to":"now"}}}},"subType":"davis-copilot","davisCopilot":{"prompt":"Identify the top 10 most problem affected entities within your environment","response":{"status":"success","data":{"dql":"fetch events\n| filter event.kind == \"DAVIS_PROBLEM\"\n| expand affected_entity_ids\n| summarize by:{affected_entity_ids}, count = countDistinct(display_id)\n| sort count desc\n| limit 10","status":"SUCCESSFUL","metadata":{"notifications":[]},"prompt":"Identify the top 10 most problem affected entities within your environment"}},"showDqlSnippet":false},"height":179},{"id":"7e319c54-62d5-4869-ad24-e8af8b15c9d9","type":"dql","showTitle":false,"state":{"input":{"value":"fetch bizevents\n| filter event.type == \"com.easytrade.buy.start\"\n| summarize by:{accountId, timestamp}, count = count()","timeframe":{"from":"now-2h","to":"now"}},"state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","isBackgroundThresholdActive":false},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"firstVisibleRowIndex":0,"columnWidths":{},"lineWrapIds":[]}},"result":{"code":200,"value":{"records":[{"accountId":6,"timestamp":"2023-12-19T14:47:17.754200000-05:00","count":"1"},{"accountId":10,"timestamp":"2023-12-19T13:46:04.891900000-05:00","count":"1"},{"accountId":10,"timestamp":"2023-12-19T15:11:08.990400000-05:00","count":"1"},{"accountId":14,"timestamp":"2023-12-19T15:39:47.458700000-05:00","count":"1"},{"accountId":15,"timestamp":"2023-12-19T15:19:26.755200000-05:00","count":"1"},{"accountId":16,"timestamp":"2023-12-19T14:52:06.487500000-05:00","count":"1"},{"accountId":17,"timestamp":"2023-12-19T13:44:57.550900000-05:00","count":"1"},{"accountId":17,"timestamp":"2023-12-19T14:40:26.461300000-05:00","count":"1"},{"accountId":18,"timestamp":"2023-12-19T13:57:49.981900000-05:00","count":"1"},{"accountId":18,"timestamp":"2023-12-19T14:10:56.957200000-05:00","count":"1"},{"accountId":21,"timestamp":"2023-12-19T14:15:04.358200000-05:00","count":"1"},{"accountId":22,"timestamp":"2023-12-19T14:02:31.072400000-05:00","count":"1"},{"accountId":22,"timestamp":"2023-12-19T15:00:06.653300000-05:00","count":"1"},{"accountId":24,"timestamp":"2023-12-19T13:50:42.255000000-05:00","count":"1"},{"accountId":24,"timestamp":"2023-12-19T15:35:53.954600000-05:00","count":"1"},{"accountId":28,"timestamp":"2023-12-19T14:27:39.848200000-05:00","count":"1"},{"accountId":28,"timestamp":"2023-12-19T14:42:08.860799700-05:00","count":"1"},{"accountId":29,"timestamp":"2023-12-19T14:35:39.259700000-05:00","count":"1"},{"accountId":30,"timestamp":"2023-12-19T13:59:34.925699800-05:00","count":"1"},{"accountId":30,"timestamp":"2023-12-19T14:31:00.768700200-05:00","count":"1"},{"accountId":34,"timestamp":"2023-12-19T15:28:15.226300200-05:00","count":"1"},{"accountId":35,"timestamp":"2023-12-19T14:26:58.154600200-05:00","count":"1"},{"accountId":38,"timestamp":"2023-12-19T13:44:59.761899800-05:00","count":"1"},{"accountId":38,"timestamp":"2023-12-19T14:38:08.152000000-05:00","count":"1"},{"accountId":39,"timestamp":"2023-12-19T14:08:54.255700000-05:00","count":"1"},{"accountId":39,"timestamp":"2023-12-19T14:33:02.197100000-05:00","count":"1"},{"accountId":39,"timestamp":"2023-12-19T15:22:12.551700000-05:00","count":"1"},{"accountId":44,"timestamp":"2023-12-19T14:14:40.680800000-05:00","count":"1"},{"accountId":44,"timestamp":"2023-12-19T15:05:08.587000000-05:00","count":"1"},{"accountId":49,"timestamp":"2023-12-19T15:30:29.655500000-05:00","count":"1"},{"accountId":52,"timestamp":"2023-12-19T13:44:27.462900000-05:00","count":"1"},{"accountId":52,"timestamp":"2023-12-19T14:20:24.147600100-05:00","count":"1"},{"accountId":53,"timestamp":"2023-12-19T14:41:34.875200000-05:00","count":"1"},{"accountId":55,"timestamp":"2023-12-19T15:18:05.356899800-05:00","count":"1"},{"accountId":57,"timestamp":"2023-12-19T15:37:43.554400300-05:00","count":"1"},{"accountId":59,"timestamp":"2023-12-19T14:09:12.679400000-05:00","count":"1"},{"accountId":59,"timestamp":"2023-12-19T14:53:20.300399900-05:00","count":"1"},{"accountId":61,"timestamp":"2023-12-19T15:29:12.050000000-05:00","count":"1"},{"accountId":62,"timestamp":"2023-12-19T15:10:22.359400200-05:00","count":"1"},{"accountId":64,"timestamp":"2023-12-19T14:00:36.954900000-05:00","count":"1"},{"accountId":64,"timestamp":"2023-12-19T14:22:08.155200000-05:00","count":"1"},{"accountId":64,"timestamp":"2023-12-19T15:37:09.570000000-05:00","count":"1"},{"accountId":66,"timestamp":"2023-12-19T14:43:22.953500000-05:00","count":"1"},{"accountId":66,"timestamp":"2023-12-19T15:18:24.660500000-05:00","count":"1"},{"accountId":70,"timestamp":"2023-12-19T14:39:29.299000000-05:00","count":"1"},{"accountId":73,"timestamp":"2023-12-19T14:16:17.578300200-05:00","count":"1"},{"accountId":74,"timestamp":"2023-12-19T14:20:59.558400300-05:00","count":"1"},{"accountId":74,"timestamp":"2023-12-19T15:12:59.657800000-05:00","count":"1"},{"accountId":74,"timestamp":"2023-12-19T15:32:15.373100000-05:00","count":"1"},{"accountId":76,"timestamp":"2023-12-19T14:54:53.259400200-05:00","count":"1"},{"accountId":77,"timestamp":"2023-12-19T15:36:30.161500000-05:00","count":"1"},{"accountId":79,"timestamp":"2023-12-19T14:38:05.254400000-05:00","count":"1"},{"accountId":81,"timestamp":"2023-12-19T14:52:59.847900200-05:00","count":"1"},{"accountId":82,"timestamp":"2023-12-19T15:03:51.075600000-05:00","count":"1"},{"accountId":84,"timestamp":"2023-12-19T14:28:48.378000000-05:00","count":"1"},{"accountId":85,"timestamp":"2023-12-19T15:06:08.953899800-05:00","count":"1"},{"accountId":85,"timestamp":"2023-12-19T15:26:45.163000000-05:00","count":"1"},{"accountId":86,"timestamp":"2023-12-19T13:55:40.814500000-05:00","count":"1"},{"accountId":87,"timestamp":"2023-12-19T13:44:23.552900000-05:00","count":"1"},{"accountId":87,"timestamp":"2023-12-19T13:47:06.765699800-05:00","count":"1"},{"accountId":87,"timestamp":"2023-12-19T14:09:27.075800000-05:00","count":"1"},{"accountId":87,"timestamp":"2023-12-19T15:14:44.964700000-05:00","count":"1"},{"accountId":87,"timestamp":"2023-12-19T15:20:39.714000000-05:00","count":"1"},{"accountId":88,"timestamp":"2023-12-19T14:31:10.551500000-05:00","count":"1"},{"accountId":89,"timestamp":"2023-12-19T15:33:15.053100000-05:00","count":"1"},{"accountId":90,"timestamp":"2023-12-19T14:48:04.426800000-05:00","count":"1"},{"accountId":91,"timestamp":"2023-12-19T13:46:41.755200300-05:00","count":"1"},{"accountId":91,"timestamp":"2023-12-19T15:28:39.947500000-05:00","count":"1"},{"accountId":95,"timestamp":"2023-12-19T13:53:48.376500000-05:00","count":"1"},{"accountId":95,"timestamp":"2023-12-19T14:23:25.472599800-05:00","count":"1"}],"metadata":{"grail":{"canonicalQuery":"fetch bizevents\n| filter event.type == \"com.easytrade.buy.start\"\n| summarize by:{accountId, timestamp}, count(), alias:count","timezone":"America/New_York","query":"fetch bizevents\n| filter event.type == \"com.easytrade.buy.start\"\n| summarize by:{accountId, timestamp}, count = count()","scannedRecords":700,"dqlVersion":"V1_0","scannedBytes":92603,"analysisTimeframe":{"start":"2023-12-19T18:43:22.728Z","end":"2023-12-19T20:43:22.728Z"},"locale":"","executionTimeMilliseconds":27,"notifications":[],"queryId":"db8798e7-9637-4381-b04c-817f9824ed9a","sampled":false}},"types":[{"mappings":{"accountId":{"type":"double"},"timestamp":{"type":"timestamp"},"count":{"type":"long"}},"indexRange":[0,69]}]},"notifications":[],"dateTime":"2023-12-19T20:43:22.705Z","input":{"value":"fetch bizevents\n| filter event.type == \"com.easytrade.buy.start\"\n| summarize by:{accountId, timestamp}, count = count()","timeframe":{"from":"now-2h","to":"now"}}},"visualization":"areaChart"},"subType":"davis-copilot","davisCopilot":{"prompt":" Count the \"com.easytrade.buy.start\" biz events summarized by \"accountId\" and summarized by timestamp","response":{"status":"success","data":{"dql":"fetch bizevents\n| filter event.type == \"com.easytrade.buy.start\"\n| summarize by:{accountId, timestamp}, count = count()","status":"SUCCESSFUL","metadata":{"notifications":[]},"prompt":" Count the \"com.easytrade.buy.start\" biz events summarized by \"accountId\" and summarized by timestamp"}},"showDqlSnippet":false}}]}